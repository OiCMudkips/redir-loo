<!DOCTYPE html>
<head>
    {>head}
</head>
<body>
    {>header}
    
    <div id="content">
    <h1>{user}'s Links</h1>
    {if rows.length}
    <button class="open-popup">Add Link</button>
    <table id="links">
        <tr><th>Destination</th><th>Shortened Link</th></tr>
        {for row in rows}
        <tr>
            <td><a rel="nofollow" href="{row.url}">{row.url}</a></td>
            <td><a href="http://placeholder.com/{row.shortened}">http://placeholder.com/{row.shortened}</a></td>
        </tr>
        {/for}
    </table>
    <button class="open-popup">Add Link</button>
    {else}
    <p>We didn't find any links for you. Add one now!</p>
    <button class="open-popup">Add Link</button>
    {/if}
    
    <div id="add-link-overlay" style="display: none">
        <button id="close-overlay">X</button>
        <input id="url" type="url" autocomplete="url">
        <button id="add-link">Add</button>
    </div>
    </div>

    {>footer}

    <script src="userpage.js"></script>
    <script>
        var overlayOpeners = document.getElementsByClassName("open-popup");
        Array.prototype.forEach.call(overlayOpeners, function(current) {
            current.addEventListener("click", openPopup);
        });
        document.getElementById("close-overlay").addEventListener("click", closePopup);
        document.getElementById("add-link").addEventListener("click", postLink);
    </script>
</body>
